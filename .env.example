#################################
# --- Postgres configuration ---
#################################
POSTGRES_USER=root
POSTGRES_PASSWORD=password
POSTGRES_DB=n8n

#################################
# --- n8n security & runtime ---
#################################
N8N_ENCRYPTION_KEY=super-secret-key
N8N_USER_MANAGEMENT_JWT_SECRET=even-more-secret

# Optional, but recommended for file uploads
N8N_DEFAULT_BINARY_DATA_MODE=filesystem

# Protect the n8n editor with Basic Auth
N8N_BASIC_AUTH_ACTIVE=true
N8N_BASIC_AUTH_USER=admin
N8N_BASIC_AUTH_PASSWORD=choose-a-strong-password

# Production mode + secure cookies
NODE_ENV=production
N8N_SECURE_COOKIE=true

# Automatically enforce correct permissions for n8n settings
N8N_ENFORCE_SETTINGS_FILE_PERMISSIONS=true

# Host + URLs (important for webhooks, OAuth, etc.)
# Replace with your real domain or IP
N8N_HOST=n8n.example.com
N8N_PROTOCOL=https
WEBHOOK_URL=https://n8n.example.com/
N8N_EDITOR_BASE_URL=https://n8n.example.com/

# Disable API for security reasons, if not needed
N8N_PUBLIC_API_DISABLED=true
N8N_PUBLIC_API_SWAGGERUI_DISABLED=true

# Isolation
# Prevent your n8n instance from connecting to n8n's servers
N8N_DIAGNOSTICS_ENABLED=false
N8N_VERSION_NOTIFICATIONS_ENABLED=false
N8N_TEMPLATES_ENABLED=false

# Unset n8n's diagnostics configuration
EXTERNAL_FRONTEND_HOOKS_URLS=
N8N_DIAGNOSTICS_CONFIG_FRONTEND=
N8N_DIAGNOSTICS_CONFIG_BACKEND=

# Disable personalised prompts or suggestions
N8N_PERSONALIZATION_ENABLED=false

#################################
# --- n8n task runners ---
#################################
N8N_RUNNERS_ENABLED=true
N8N_RUNNERS_MODE=external
N8N_RUNNERS_AUTH_TOKEN=very-secret-key
N8N_RUNNERS_AUTO_SHUTDOWN_TIMEOUT=15
N8N_NATIVE_PYTHON_RUNNER=true

#################################
# --- Execution retention ---
#################################
# Keeps the database small over time
EXECUTIONS_DATA_PRUNE=true
EXECUTIONS_DATA_MAX_AGE=168          # hours (7 days)
EXECUTIONS_DATA_PRUNE_MAX_COUNT=5000
EXECUTIONS_DATA_SAVE_ON_ERROR=all
EXECUTIONS_DATA_SAVE_ON_SUCCESS=none

#################################
# --- Ollama / AI service ---
#################################
# Default model pulled automatically during startup
OLLAMA_DEFAULT_MODEL=gpt-oss:20b
# Default points to internal service
OLLAMA_HOST=ollama:11434
# Keep the model resident (avoid cold starts). Change to e.g. 15m if you prefer auto-unload.
OLLAMA_KEEP_ALIVE=-1
# Cap concurrency at 2 requests in parallel.
OLLAMA_NUM_PARALLEL=2
# Memory-saving KV cache to fit 20B + 2-way parallelism on 16 GB.
OLLAMA_KV_CACHE_TYPE=q4_0
# Default context length; increase only if you have headroom.
OLLAMA_CONTEXT_LENGTH=4096
# Enable fast attention kernels when supported.
OLLAMA_FLASH_ATTENTION=1
# Optionally pin to a specific GPU index if multiple present:
# - CUDA_VISIBLE_DEVICES=0

#################################
# --- Timezone ---
#################################
TZ=Etc/UTC
